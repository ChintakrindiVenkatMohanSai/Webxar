<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Wall AR Colour & Texture</title>

<style>
body{
margin:0;
overflow:hidden;
font-family:Arial;
background:black;
}

/* Camera video */
video{
position:fixed;
width:100%;
height:100%;
object-fit:cover;
z-index:1;
}

/* Overlay */
#overlay{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(255,0,0,.4);
z-index:5;
touch-action:none;
}

/* Control panel */
.panel{
position:fixed;
bottom:10px;
left:50%;
transform:translateX(-50%);
background:rgba(0,0,0,.7);
padding:18px;
border-radius:14px;
color:white;
z-index:10;
text-align:center;
}

input,button{
margin:6px;
padding:6px;
}
</style>
</head>

<body>

<div id="overlay"></div>

<div class="panel">

ðŸŽ¨ Wall AR Studio<br><br>

RGB Color:
<input type="color" onchange="setColor(this.value)">

<br>

Upload Texture:
<input type="file" accept="image/*" onchange="uploadTexture(event)">

<br>

Opacity:
<input type="range" min="0" max="1" step="0.05"
value="0.4" onchange="setOpacity(this.value)">

</div>

<script>
let overlay=document.getElementById("overlay");
let scale=1,posX=0,posY=0,startDist=0;

/* Start camera */
async function startCamera(){
try{
const stream=await navigator.mediaDevices.getUserMedia({
video:{facingMode:"environment"}
});

let video=document.createElement("video");
video.srcObject=stream;
video.autoplay=true;
document.body.appendChild(video);

}catch(e){
alert("Camera not supported");
}
}

/* RGB Color */
function setColor(color){
overlay.style.background=color;
overlay.style.backgroundImage="none";
}

/* Upload Texture */
function uploadTexture(e){
let file=e.target.files[0];
if(!file) return;

let reader=new FileReader();
reader.onload=function(ev){
overlay.style.backgroundImage=`url('${ev.target.result}')`;
overlay.style.backgroundSize="cover";
overlay.style.backgroundRepeat="no-repeat";
overlay.style.backgroundPosition="center";
};
reader.readAsDataURL(file);
}

/* Opacity */
function setOpacity(val){
overlay.style.opacity=val;
}

/* Pinch Zoom + Drag */
overlay.addEventListener("touchstart",e=>{
if(e.touches.length==2)
startDist=getDist(e);
});

overlay.addEventListener("touchmove",e=>{
e.preventDefault();

if(e.touches.length==1){
posX+=e.touches[0].movementX||0;
posY+=e.touches[0].movementY||0;
}

if(e.touches.length==2){
let newDist=getDist(e);
scale*=newDist/startDist;
startDist=newDist;
}

overlay.style.backgroundSize=
`${100*scale}% ${100*scale}%`;

overlay.style.backgroundPosition=
`${posX}px ${posY}px`;
});

function getDist(e){
let dx=e.touches[0].clientX-e.touches[1].clientX;
let dy=e.touches[0].clientY-e.touches[1].clientY;
return Math.sqrt(dx*dx+dy*dy);
}

window.onload=startCamera;
</script>

</body>
</html>